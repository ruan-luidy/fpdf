<hc:Window
  x:Class="fpdf.Wpf.Views.Dialogs.SettingsDialog"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:hc="https://handyorg.github.io/handycontrol"
  xmlns:icon="http://metro.mahapps.com/winfx/xaml/iconpacks"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="clr-namespace:fpdf.Wpf.ViewModels"
  Title="Configuracoes"
  Width="500"
  Height="600"
  d:DataContext="{d:DesignInstance Type=vm:SettingsViewModel}"
  ResizeMode="NoResize"
  ShowInTaskbar="False"
  WindowStartupLocation="CenterOwner"
  mc:Ignorable="d">

  <Grid Margin="0">
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
      <StackPanel Margin="10">
        <!--  Impressao  -->
        <Border Margin="0,0,0,16" Style="{StaticResource BorderRegion}">
          <StackPanel Margin="16">
            <TextBlock Margin="0,0,0,4" Text="Impressora padrao:" />
            <ComboBox
              DisplayMemberPath="DisplayName"
              ItemsSource="{Binding Printers}"
              SelectedValue="{Binding DefaultPrinter}"
              SelectedValuePath="Name" />

            <TextBlock Margin="0,16,0,4" Text="Copias padrao:" />
            <hc:NumericUpDown
              Maximum="100"
              Minimum="1"
              Value="{Binding DefaultCopies}" />

            <CheckBox
              Margin="0,16,0,0"
              Content="Duplex por padrao"
              IsChecked="{Binding DefaultDuplex}" />
          </StackPanel>
        </Border>

        <!--  Aparencia  -->
        <hc:Card Margin="0,0,0,16" Header="Aparencia">
          <StackPanel Margin="16">
            <TextBlock Margin="0,0,0,4" Text="Tema:" />
            <ComboBox ItemsSource="{Binding AvailableThemes}" SelectedItem="{Binding Theme}" />

            <CheckBox
              Margin="0,16,0,0"
              Content="Mostrar miniaturas"
              IsChecked="{Binding ShowThumbnails}" />

            <TextBlock Margin="0,16,0,4" Text="Tamanho da miniatura:" />
            <Slider
              IsSnapToTickEnabled="True"
              Maximum="128"
              Minimum="32"
              TickFrequency="16"
              Value="{Binding ThumbnailSize}" />
            <TextBlock HorizontalAlignment="Right" Text="{Binding ThumbnailSize, StringFormat='{}{0}px'}" />
          </StackPanel>
        </hc:Card>

        <!--  Navegacao  -->
        <hc:Card Margin="0,0,0,16" Header="Navegacao">
          <StackPanel Margin="16">
            <CheckBox Content="Lembrar ultima pasta aberta" IsChecked="{Binding RememberLastFolder}" />
          </StackPanel>
        </hc:Card>

        <!--  Pastas favoritas  -->
        <hc:Card Margin="0,0,0,16" Header="Pastas Favoritas">
          <Grid Margin="16">
            <Grid.RowDefinitions>
              <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <ListBox MaxHeight="150" ItemsSource="{Binding FavoriteFolders}">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*" />
                      <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock
                      VerticalAlignment="Center"
                      Text="{Binding}"
                      TextTrimming="CharacterEllipsis" />

                    <Button
                      Grid.Column="1"
                      Command="{Binding DataContext.RemoveFavoriteFolderCommand, RelativeSource={RelativeSource AncestorType=hc:Window}}"
                      CommandParameter="{Binding}"
                      Style="{StaticResource ButtonIcon}"
                      ToolTip="Remover">
                      <icon:PackIconPhosphorIcons
                        Width="12"
                        Height="12"
                        Kind="X" />
                    </Button>
                  </Grid>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>

            <TextBlock
              HorizontalAlignment="Center"
              VerticalAlignment="Center"
              Foreground="{DynamicResource SecondaryTextBrush}"
              Text="Nenhuma pasta favorita"
              Visibility="{Binding FavoriteFolders.Count, Converter={StaticResource Int2VisibilityReConverter}}" />
          </Grid>
        </hc:Card>

        <!--  Pastas recentes  -->
        <hc:Card Header="Pastas Recentes">
          <Grid Margin="16">
            <Grid.RowDefinitions>
              <RowDefinition Height="*" />
              <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <ListBox MaxHeight="100" ItemsSource="{Binding RecentFolders}">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis" />
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>

            <Button
              Grid.Row="1"
              Margin="0,8,0,0"
              HorizontalAlignment="Right"
              Command="{Binding ClearRecentFoldersCommand}"
              Content="Limpar Historico" />
          </Grid>
        </hc:Card>
      </StackPanel>
    </ScrollViewer>

    <!--  Botoes  -->
    <StackPanel
      Grid.Row="1"
      Margin="0,16,0,0"
      HorizontalAlignment="Right"
      Orientation="Horizontal">
      <Button
        Width="100"
        Click="Cancel_Click"
        Content="Cancelar"
        IsCancel="True" />
      <Button
        Width="100"
        Margin="8,0,0,0"
        Click="Save_Click"
        Content="Salvar"
        Style="{StaticResource ButtonPrimary}" />
    </StackPanel>
  </Grid>
</hc:Window>
